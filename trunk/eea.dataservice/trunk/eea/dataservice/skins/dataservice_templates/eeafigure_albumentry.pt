<metal:entry define-macro="entry" tal:define="
  css python:brain.is_folderish and 'photoAlbumEntry photoAlbumFolder' or 'photoAlbumEntry';
  display obj/@@imgview/display|nothing;">
  <div tal:attributes="class python:display and css or 'figuresPhotoAlbumEntry'">
    <a tal:condition="display" tal:attributes="
      href listing_url;
      title python:obj_title">
      <span class="photoAlbumEntryWrapper">
      <img style="border: none" tal:attributes="
        title obj_title;
        alt obj/pretty_title_or_id;
        src string:${obj/absolute_url}/image_thumb"/>
      </span>
      <span class="photoAlbumEntryTitle" tal:content="obj/pretty_title_or_id" />
    </a>
    <div class="figuresPhotoAlbumEntryTitle" tal:define="
      field obj/getFile | nothing;
      size field/get_size | nothing;
      icon field/getBestIcon | nothing;"
      tal:condition="not:display">

      <div class="figuresByLine" tal:attributes="
        style string:background-image: url($listing_url/image_thumb)">
        <tal:size tal:condition="size" tal:define="
          displaySize nocall:here/@@displaySize;
          size python:size and displaySize(size);
          ctype python:size and obj.lookupMime(field.getContentType());">
          <img tal:condition="icon"
            tal:attributes="src string:${context/portal_url}/$icon"/>
          <span tal:content="ctype" /><br />
          <span tal:content="size" />
        </tal:size>
      </div>
      <a tal:define="suffix python:size and '/at_download/file' or ''"
        tal:attributes="
          href string:$listing_url$suffix;
          title desc_or_title"
          tal:content="obj_title">Title here</a>
    </div>
  </div>
</metal:entry>
