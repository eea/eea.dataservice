<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="eea.translations">

<body>

<div metal:fill-slot="main">
    <style>
        dd {margin-left: 3em}

        #map_canvas {
            float: left;
            margin-right: 10px;
            margin-top: 3px; }
    </style>

    <!-- BASIC PROPERTIES -->
    <!-- Title -->
    <h1 tal:content="here/pretty_title_or_id">Title of the Dataset</h1>
    <div class="documentActions languages">
        <tal:lang tal:condition="exists: here/global_languageselector">
            <metal:lang use-macro="here/global_languageselector/macros/language" />
        </tal:lang>
    </div>
    <div class="visualClear">&nbsp;</div>

    <!-- Description -->
    <div class="publicationDescription">
        <strong tal:content="here/Description" />
    </div>

    <!-- Versions -->
    <metal:themes use-macro="here/portlet_versions/macros/portlet" />

    <!-- Themes -->
    <metal:themes use-macro="here/portlet_themes_object/macros/portlet" />

    <!-- Tables -->
    <tal:tables repeat="categ python:here.getTablesByCategory().keys()">
        <h4 tal:content="python:here.getCategoryName(categ)" />
        <tal:block repeat="table python:here.getTablesByCategory()[categ]">
            <h5 tal:content="table/title" />
            <p tal:content="table/Description" />
            <span style="font-style: italic">Records: <tal:block tal:content="table/records" /></span>
            <ul>
                <li tal:repeat="file python:table.objectValues('DataFile')">
                    <tal:block define="field python:file.getField('file');
                                       accessor python:field.getAccessor(file)();
                                       icon accessor/getBestIcon | nothing;
                                       filename accessor/filename | nothing;
                                       size accessor/get_size | python:accessor and len(accessor) or 0;">

                        <a href="" tal:attributes="href string:${file/absolute_url}/at_download/file">
                            <img tal:condition="icon" src=""
                                 tal:attributes="src string:${here/portal_url}/$icon"/>
                            <span tal:content="filename" />
                        </a>
                        (<span tal:content="python:file.lookupMime(field.getContentType(file))">ContentType</span>
                        <tal:size content="python:'%sKb' % (size / 1024)">0Kb</tal:size>)
                        <br />
                    </tal:block>
                </li>
            </ul>
        </tal:block>
    </tal:tables>

    <!-- META DATA -->
    <h4>Meta data</h4>
    <div style="margin-left: 5%;">
    <dl>

    <!-- Short ID (debug) -->
    <tal:block define="field python:here.getField('shortId');
                       value python:field.getAccessor(here)()"
               condition="value">
        <dt i18n:translate="dataset_unit">Short ID:</dt>
        <dd tal:content="structure value">Short ID</dd>
    </tal:block>

    <!-- UID (debug) -->
    <dt>UID:</dt>
    <dd tal:content="here/UID" />

    <!-- Geographical coverage -->
    <tal:block define="field python:here.getField('geographicCoverage');
                       value python:field.getAccessor(here)()"
               condition="value">
        <dt i18n:translate="dataset_geographical">Geographical coverage:</dt>

        <dd>
            <tal:map define="map nocall:here/@@getGeographicalCoverageMap; map python:map(cc=value);"
                     content="structure map" />
            <div id='map_canvas'></div>
            <tal:block define="view nocall:here/@@getCountriesDisplay">
                <div tal:content="python:view(list(value))" />
            </tal:block>
            <div class="visualClear">&nbsp;</div>
        </dd>
    </tal:block>

    <!-- Geographic information quality -->
    <tal:block define="field python:here.getField('geoQuality');
                       value python:field.getAccessor(here)()"
               condition="python:value != ('-1', '-1', '-1', '-1', '-1')">
        <dt i18n:translate="dataset_quality">Geographic information quality label:</dt>
        <dd>
            <span>Completeness:</span>
            <tal:quality define="quality_view nocall:here/@@getQualityDisplay;
                                 qview python:quality_view(value=value[0]);"
                         content="structure qview" />
            <span>Logical consistency:</span>
            <tal:quality define="quality_view nocall:here/@@getQualityDisplay;
                                 qview python:quality_view(value=value[1]);"
                         content="structure qview" />
            <span>Position accuracy:</span>
            <tal:quality define="quality_view nocall:here/@@getQualityDisplay;
                                 qview python:quality_view(value=value[2]);"
                         content="structure qview" />
            <span>Temporal accuracy:</span>
            <tal:quality define="quality_view nocall:here/@@getQualityDisplay;
                                 qview python:quality_view(value=value[3]);"
                         content="structure qview" />
            <span>Thematic accuracy:</span>
            <tal:quality define="quality_view nocall:here/@@getQualityDisplay;
                                 qview python:quality_view(value=value[4]);"
                         content="structure qview" />
        </dd>
    </tal:block>

    <!-- EEA management plan code -->
    <tal:block define="field python:here.getField('eeaManagementPlan');
                       value python:field.getAccessor(here)()"
               condition="python:value != ('', '')">
        <dt i18n:translate="dataset_plan_code">EEA management plan code:</dt>
        <dd>
            <span>year:</span>&nbsp;<tal:block content="python:value[0]" />,
            <span>code:</span>&nbsp;<tal:block content="python:value[1]" />
        </dd>
    </tal:block>

    <!-- Publish date -->
    <tal:block define="value here/getEffectiveDate" condition="value">
        <dt i18n:translate="dataset_keywords">Publish date:</dt>
        <dd tal:content="value" />
    </tal:block>

    <!-- Keyword(s) -->
    <tal:block define="value here/getKeywords" condition="value">
        <dt i18n:translate="dataset_keywords">Keyword(s):</dt>
        <dd tal:content="value" />
    </tal:block>

    <!-- Rights -->
    <tal:block define="value here/Rights" condition="value">
        <dt i18n:translate="dataset_rights">Rights:</dt>
        <dd tal:content="structure python:value.replace('\n', '<br />')" />
    </tal:block>

    <!-- Last upload -->
    <tal:block define="field python:here.getField('effectiveDate');
                       value python:field.getAccessor(here)()"
               condition="value">
        <dt i18n:translate="dataset_last_upload">Last upload:</dt>
        <dd tal:content="structure value">Last upload</dd>
    </tal:block>

    <!-- Scale of the data set -->
    <tal:block define="field python:here.getField('scale');
                       value python:field.getAccessor(here)()"
              condition="value">
        <dt i18n:translate="dataset_scale">Scale of the data set:</dt>
        <dd><span>1:</span><tal:scale content="structure value" /></dd>
    </tal:block>

    <!-- Additional information -->
    <tal:block define="field python:here.getField('moreInfo');
                       value python:field.getAccessor(here)()"
               condition="value">
        <dt i18n:translate="dataset_aditional_info">Additional information:</dt>
        <dd tal:content="structure value">Additional information</dd>
    </tal:block>

    <!-- Disclaimer -->
    <tal:block define="field python:here.getField('disclaimer');
                       value python:field.getAccessor(here)()"
               condition="value">
        <dt i18n:translate="dataset_disclaimer">Disclaimer:</dt>
        <dd tal:content="structure value">Disclaimer</dd>
    </tal:block>

    <!-- Geographic accuracy -->
    <tal:block define="field python:here.getField('geoAccuracy');
                       value python:field.getAccessor(here)()"
               condition="value">
        <dt i18n:translate="dataset_accuracy">Geographic accuracy:</dt>
        <dd tal:content="structure value">Geographic accuracy</dd>
    </tal:block>

    <!-- Source -->
    <tal:block define="field python:here.getField('dataSource');
                       vocab python:field.Vocabulary(here);
                       values python:field.getAccessor(here)();
                       value python:here.displayValue(vocab, values)"
               condition="value">
        <dt i18n:translate="dataset_source">Source:</dt>
        <dd tal:content="structure value">source</dd>
    </tal:block>

    <!-- Methodology -->
    <tal:block define="field python:here.getField('methodology');
                       value python:field.getAccessor(here)()"
               condition="value">
        <dt i18n:translate="dataset_methodology">Methodology:</dt>
        <dd tal:content="structure value">Methodology</dd>
    </tal:block>

    <!-- Unit -->
    <tal:block define="field python:here.getField('units');
                       value python:field.getAccessor(here)()"
               condition="value">
        <dt i18n:translate="dataset_unit">Unit:</dt>
        <dd tal:content="structure value">Unit</dd>
    </tal:block>

    <!-- Temporal coverage -->
    <tal:block define="field python:here.getField('temporalCoverage');
                       value python:field.getAccessor(here)()"
               condition="value">
        <dt i18n:translate="dataset_temporalCoverage">Temporal coverage:</dt>
        <dd tal:content="here/@@formatTempCoverage" />
    </tal:block>

    <!-- Contact person(s) for EEA -->
    <tal:block define="field python:here.getField('contact');
                       value python:field.getAccessor(here)()"
               condition="value">
        <dt i18n:translate="dataset_contact">Contact person(s) for EEA:</dt>
        <dd tal:content="structure python:value.replace('\r\n', '<br />')">Contact person(s) for EEA</dd>
    </tal:block>

    <!-- Reference system -->
    <tal:block define="field python:here.getField('referenceSystem');
                       value python:field.getAccessor(here)()"
               condition="value">
        <dt i18n:translate="dataset_unit">Reference system:</dt>
        <dd tal:content="structure value">Reference system</dd>
    </tal:block>

    <!-- Owner -->
    <tal:block define="field python:here.getField('dataOwner');
                       urls python:field.getAccessor(here)()"
               condition="urls">
        <dt i18n:translate="dataset_owner">Owner:</dt>
        <tal:block repeat="url urls">
            <dd tal:define="value python:here.getOrganisationName(url)">
                <span tal:content="value/Title" /><br />
                <a href="#" title=""
                   tal:attributes="href value/getUrl; title value/Title"
                   tal:content="value/getUrl" />
            </dd>
        </tal:block>
    </tal:block>

    <!-- Processor -->
    <tal:block define="field python:here.getField('processor');
                       url python:field.getAccessor(here)();
                       value python:here.getOrganisationName(url)"
               condition="value">
        <dt i18n:translate="dataset_processor">Processor:</dt>
        <dd>
            <span tal:content="value/Title" /><br />
            <a href="#" title=""
               tal:attributes="href value/getUrl; title value/Title"
               tal:content="value/getUrl" />
        </dd>
    </tal:block>

    </dl>
    </div>
    <div class="visualClear">&nbsp;</div>
</div>

</body>
</html>
